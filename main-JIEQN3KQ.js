import{a as s}from"./chunk-3ZMFM4FV.js";import{c as H,d as k,e as I,f as R,g as x,h as E,i as T,k as F}from"./chunk-I67OAI3P.js";import{I as w,Ia as A,T as p,_a as b,ba as v,ca as C,n as c,nb as y,y as f}from"./chunk-3C4K6DAS.js";function d(t){this.message=t}d.prototype=new Error,d.prototype.name="InvalidCharacterError";var D=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var o=String(t).replace(/=+$/,"");if(o.length%4==1)throw new d("'atob' failed: The string to be decoded is not correctly encoded.");for(var e,r,n=0,a=0,i="";r=o.charAt(a++);~r&&(e=n%4?64*e+r:r,n++%4)?i+=String.fromCharCode(255&e>>(-2*n&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return i};function B(t){var o=t.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw"Illegal base64url string!"}try{return(function(e){return decodeURIComponent(D(e).replace(/(.)/g,function(r,n){var a=n.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))})(o)}catch{return D(o)}}function m(t){this.message=t}function G(t,o){if(typeof t!="string")throw new m("Invalid token specified");var e=(o=o||{}).header===!0?0:1;try{return JSON.parse(B(t.split(".")[e]))}catch(r){throw new m("Invalid token specified: "+r.message)}}m.prototype=new Error,m.prototype.name="InvalidTokenError";var M=G;var L=()=>{let t=p(s),o=p(T),e=t.getAccessToken();if(!e)return o.navigate(["/login"]),!1;try{let r=M(e),n=Math.floor(Date.now()/1e3);return r.exp&&r.exp<n?(t.logout(),o.navigate(["/login"]),!1):!0}catch{return t.logout(),o.navigate(["/login"]),!1}};var P=[{path:"",loadComponent:()=>import("./chunk-4Z6GZCCC.js").then(t=>t.Home)},{path:"labs",loadComponent:()=>import("./chunk-FYJFTZAF.js").then(t=>t.Labs)},{path:"login",loadComponent:()=>import("./chunk-3VBKEKRK.js").then(t=>t.Login)},{path:"control-panel",loadComponent:()=>import("./chunk-AU7CXVIE.js").then(t=>t.ControlPanel),canActivate:[L]}];var N=(t,o)=>{let e=p(s),r=p(I),n=e.getAccessToken(),a=t;return n&&(a=t.clone({setHeaders:{Authorization:`Bearer ${n}`}})),o(a).pipe(f(i=>{if(i.status!==401)return c(()=>i);let h=e.refreshToken();return h?h.pipe(w(u=>{let g=u.accessToken||e.getAccessToken();if(!g)return e.logout(),c(()=>i);let j=t.clone({setHeaders:{Authorization:`Bearer ${g}`}});return o(j)}),f(u=>(e.logout(),c(()=>u)))):(e.logout(),c(()=>i))}))};var S={providers:[v(),y({eventCoalescing:!0}),F(P),R(x([N])),s]};var l=class t{title=C("agendamentoFabLab");static \u0275fac=function(e){return new(e||t)};static \u0275cmp=A({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(e,r){e&1&&b(0,"router-outlet")},dependencies:[E,H],encapsulation:2})};k(l,S).catch(t=>console.error(t));
